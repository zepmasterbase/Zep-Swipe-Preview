<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zep Swipe ‚Äî Withdraw</title>

<!-- Tailwind CDN for quick utilities -->
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#0b0520;
    --glass: rgba(255,255,255,0.04);
    --glass-2: rgba(255,255,255,0.02);
    --neon-a: #00f0ff;
    --neon-b: #ff00f0;
    --accent: linear-gradient(90deg,var(--neon-a),var(--neon-b));
  }

  body{
    font-family: 'Poppins', sans-serif;
    background: radial-gradient(circle at 10% 10%, #15102a 0%, var(--bg) 60%);
    min-height:100vh; margin:0; padding:1rem; color:#e9eefb;
    display:flex; align-items:center; justify-content:center;
  }

  /* Card */
  .panel{
    width:100%; max-width:760px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:16px; padding:1.2rem;
    box-shadow: 0 10px 40px rgba(2,6,23,0.7), 0 0 30px rgba(0,240,255,0.03);
    border: 1px solid rgba(255,255,255,0.04);
  }

  .top-row{ display:flex; gap:1rem; align-items:center; justify-content:space-between; flex-wrap:wrap; }
  .balance-box{
    background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:0.9rem 1rem; border-radius:12px; min-width:220px;
    box-shadow: inset 0 -6px 16px rgba(11,5,32,0.4);
    border: 1px solid rgba(124,99,255,0.04);
  }
  .balance-label{ color:#bfc8ff; font-size:0.9rem; }
  .balance-amount{ font-family:'Exo 2',sans-serif; font-size:1.6rem; color:var(--neon-a); font-weight:700; margin-top:0.2rem; letter-spacing:0.5px; }

  /* Methods tabs */
  .tabs{ display:flex; gap:0.6rem; margin-top:1rem; }
  .tab{
    flex:1; display:flex; gap:0.6rem; align-items:center; padding:0.6rem; border-radius:12px;
    background:var(--glass-2); border:1px solid rgba(255,255,255,0.02); cursor:pointer;
    transition: all 0.18s ease;
  }
  .tab[data-active="true"]{
    background: linear-gradient(90deg, rgba(0,240,255,0.06), rgba(255,0,240,0.06));
    box-shadow: 0 6px 20px rgba(0,240,255,0.06);
    transform: translateY(-4px);
    border: 1px solid rgba(124,99,255,0.14);
  }
  .tab .icon{
    width:44px;height:44px;border-radius:10px; display:flex; align-items:center; justify-content:center;
    background: rgba(255,255,255,0.02); color:var(--neon-a); font-size:1.1rem;
  }
  .tab .name{ font-weight:600; color:#dfe7ff; font-size:0.95rem; }

  /* Amount controls */
  .amount-panel{ margin-top:1rem; display:flex; gap:1rem; flex-direction:column; }
  .amount-input{ display:flex; gap:0.6rem; align-items:center; }
  .amount-input input[type="number"]{
    flex:1; padding:0.7rem; border-radius:12px; border:none; background:var(--glass); color:#eaf2ff; font-weight:700;
    font-size:1.05rem; text-align:right;
  }
  .max-btn{ padding:0.5rem 0.8rem; border-radius:10px; background:transparent; border:1px solid rgba(255,255,255,0.04); color:#a8b9ff; cursor:pointer; }

  /* slider */
  .slider-wrap{ margin-top:0.6rem; }
  input[type="range"]{
    -webkit-appearance:none; width:100%; height:8px; border-radius:999px; background:linear-gradient(90deg, rgba(124,99,255,0.12), rgba(124,99,255,0.06));
    outline:none;
  }
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none; width:22px;height:22px;border-radius:50%; background:var(--neon-a); box-shadow:0 0 12px rgba(0,240,255,0.35);
    border:3px solid rgba(11,5,32,0.85);
  }

  /* progress */
  .progress {
    height:10px; background: rgba(255,255,255,0.03); border-radius:999px; overflow:hidden; margin-top:0.7rem;
    border:1px solid rgba(255,255,255,0.02);
  }
  .progress .bar { height:100%; width:0%; background: linear-gradient(90deg,var(--neon-a),var(--neon-b)); transition: width 800ms cubic-bezier(.2,.9,.2,1); }

  /* withdraw button */
  .withdraw-btn{
    margin-top:1rem; width:100%; padding:0.9rem; border-radius:14px; border:none; font-weight:800; letter-spacing:0.4px;
    color:#051225; background:var(--accent); box-shadow: 0 10px 30px rgba(0,240,255,0.08);
    cursor:pointer; transform: translateZ(0); transition: transform 150ms ease, box-shadow 200ms;
  }
  .withdraw-btn:active{ transform: translateY(2px) scale(0.998); box-shadow: 0 6px 20px rgba(0,240,255,0.06); }

  /* microinteractions */
  .glow {
    position:relative;
  }
  .glow::after{
    content:''; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
    box-shadow: 0 0 18px rgba(0,240,255,0.04), 0 0 40px rgba(255,0,240,0.02);
    opacity:0; transition:opacity 240ms ease;
  }
  .tab[data-active="true"] .glow::after { opacity:1; }

  /* confirmation modal */
  .modal-backdrop { position:fixed; inset:0; background:rgba(2,6,23,0.6); display:none; align-items:center; justify-content:center; z-index:60; }
  .modal {
    width:92%; max-width:420px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border-radius:14px; padding:1rem; text-align:center; border:1px solid rgba(255,255,255,0.04);
    box-shadow: 0 12px 50px rgba(0,0,0,0.7);
    transform: translateY(20px); opacity:0; transition: all 300ms ease;
  }
  .modal.show { transform: translateY(0); opacity:1; }
  .check {
    width:72px;height:72px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;margin:0.5rem auto;
    background:linear-gradient(90deg,var(--neon-a),var(--neon-b)); box-shadow: 0 8px 36px rgba(0,240,255,0.08);
  }
  .check svg { transform:scale(0); animation: pop 420ms forwards 160ms; }
  @keyframes pop { to{ transform:scale(1); } }

  /* responsive tweaks */
  @media (max-width:520px){
    .top-row{ flex-direction:column; align-items:stretch; gap:0.6rem; }
    .tabs{ flex-direction:column; }
    .tab{ justify-content:flex-start; }
  }
</style>
</head>
<body>

<div class="panel">
  <div class="top-row">
    <div>
      <div class="balance-box">
        <div class="balance-label">Available balance</div>
        <div id="balance" class="balance-amount">5,000 ZAC</div>
        <div class="small mt-1" style="color:#b9c8ff">Equivalent: $45.00</div>
      </div>
    </div>

    <div style="min-width:220px;">
      <div class="balance-box">
        <div class="balance-label">Withdraw fee</div>
        <div id="fee" class="balance-amount" style="font-size:1.1rem; color:#ffd480">0.5%</div>
        <div class="small mt-1" style="color:#b9c8ff">Network fee & processing</div>
      </div>
    </div>
  </div>

  <!-- methods -->
  <div class="tabs" role="tablist" aria-label="Withdraw methods" id="methods">
    <div class="tab" role="tab" data-method="momo" data-active="true" tabindex="0">
      <div class="icon">üì±</div>
      <div>
        <div class="name">Momo</div>
        <div class="small">Mobile money</div>
      </div>
    </div>
    <div class="tab" role="tab" data-method="fnb" data-active="false" tabindex="0">
      <div class="icon">üè¶</div>
      <div>
        <div class="name">FNB eWallet</div>
        <div class="small">Bank transfer</div>
      </div>
    </div>
    <div class="tab" role="tab" data-method="crypto" data-active="false" tabindex="0">
      <div class="icon">üîó</div>
      <div>
        <div class="name">Crypto Wallet</div>
        <div class="small">External address</div>
      </div>
    </div>
  </div>

  <!-- amount -->
  <div class="amount-panel">
    <div class="amount-input">
      <input id="amountInput" type="number" min="0" step="1" value="0" aria-label="Withdrawal amount" />
      <button id="maxBtn" class="max-btn">Max</button>
    </div>

    <div class="slider-wrap">
      <input id="range" type="range" min="0" max="5000" value="0" />
      <div class="progress" aria-hidden="true"><div class="bar" id="progressBar" style="width:0%"></div></div>
      <div class="small" style="display:flex;justify-content:space-between;margin-top:6px;color:#aeb9ff">
        <span>0 ZAC</span>
        <span id="rangeMax">5,000 ZAC</span>
      </div>
    </div>

    <!-- destination info (changes per method) -->
    <div id="destination" class="mt-3">
      <!-- dynamic form -->
      <div id="dest-momo" class="dest-form">
        <label class="small">Recipient phone</label>
        <input id="momoPhone" placeholder="+2348012345678" />
      </div>
      <div id="dest-fnb" class="dest-form" style="display:none;">
        <label class="small">Bank account / eWallet ID</label>
        <input id="fnbAcc" placeholder="Account or wallet ID" />
      </div>
      <div id="dest-crypto" class="dest-form" style="display:none;">
        <label class="small">Recipient wallet address</label>
        <input id="cryptoAddr" placeholder="0x..." />
      </div>
    </div>

    <!-- summary -->
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:0.8rem;">
      <div class="small">You will receive</div>
      <div id="receiveAmount" style="font-weight:800;color:#ffe6a8">0 ZAC</div>
    </div>

    <!-- withdraw action -->
    <button id="withdrawBtn" class="withdraw-btn">Withdraw</button>

    <!-- small hint -->
    <div class="small" style="margin-top:0.6rem;color:#aeb9ff">Transactions may take a few minutes depending on the method. Max withdraw limit: 5,000 ZAC</div>
  </div>
</div>

<!-- Modal -->
<div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal" id="modal">
    <div class="check" id="checkWrap">
      <!-- SVG check -->
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#041223" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 6L9 17l-5-5" stroke="#041223"/>
      </svg>
    </div>
    <h3 id="modalTitle" style="font-family:'Exo 2',sans-serif;margin-top:6px;">Success</h3>
    <p id="modalMessage" style="color:#bfdcff;">Your withdrawal was processed.</p>
    <div style="margin-top:0.6rem;">
      <button id="closeModal" class="btn" style="background:var(--accent); color:#08102a; padding:0.6rem 0.9rem; border-radius:10px;">Done</button>
    </div>
  </div>
</div>

<script>
  // initial state
  const BALANCE = 5000; // ZAC
  const FEE_PERCENT = 0.5; // fee %
  const amountInput = document.getElementById('amountInput');
  const range = document.getElementById('range');
  const progressBar = document.getElementById('progressBar');
  const maxBtn = document.getElementById('maxBtn');
  const balanceEl = document.getElementById('balance');
  const receiveAmountEl = document.getElementById('receiveAmount');
  const withdrawBtn = document.getElementById('withdrawBtn');
  const methodsEl = document.getElementById('methods');
  const tabs = Array.from(document.querySelectorAll('.tab'));
  const destMomo = document.getElementById('dest-momo');
  const destFnb = document.getElementById('dest-fnb');
  const destCrypto = document.getElementById('dest-crypto');
  const modalBackdrop = document.getElementById('modalBackdrop');
  const modal = document.getElementById('modal');
  const modalTitle = document.getElementById('modalTitle');
  const modalMessage = document.getElementById('modalMessage');
  const checkWrap = document.getElementById('checkWrap');
  const closeModal = document.getElementById('closeModal');
  const feeEl = document.getElementById('fee');
  const rangeMax = document.getElementById('rangeMax');

  // Set initial UI values
  balanceEl.textContent = BALANCE.toLocaleString() + ' ZAC';
  range.max = BALANCE;
  range.value = 0;
  rangeMax.textContent = BALANCE.toLocaleString() + ' ZAC';
  amountInput.value = 0;
  receiveAmountEl.textContent = '0 ZAC';
  feeEl.textContent = `${FEE_PERCENT}%`;

  // active tab logic
  function setActiveMethod(method){
    tabs.forEach(t => {
      const is = t.dataset.method === method;
      t.dataset.active = is ? "true" : "false";
    });
    // show destination fields
    destMomo.style.display = method === 'momo' ? '' : 'none';
    destFnb.style.display = method === 'fnb' ? '' : 'none';
    destCrypto.style.display = method === 'crypto' ? '' : 'none';
  }
  // init default
  setActiveMethod('momo');

  // tab click handlers
  tabs.forEach(tab => {
    tab.addEventListener('click', () => setActiveMethod(tab.dataset.method));
    tab.addEventListener('keydown', e => { if(e.key === 'Enter' || e.key === ' ') setActiveMethod(tab.dataset.method); });
  });

  // sync slider & number input & progress
  function updateFromAmount(val){
    // clamp
    let a = Number(val) || 0;
    if(a < 0) a = 0;
    if(a > BALANCE) a = BALANCE;
    amountInput.value = a;
    range.value = a;
    const pct = (a / BALANCE) * 100;
    progressBar.style.width = pct + '%';
    // compute fee & receive amount
    const fee = (FEE_PERCENT/100) * a;
    const receive = (a - fee);
    receiveAmountEl.textContent = `${Number(receive).toLocaleString(undefined, {maximumFractionDigits:2})} ZAC`;
  }

  amountInput.addEventListener('input', (e) => updateFromAmount(e.target.value));
  range.addEventListener('input', (e) => updateFromAmount(e.target.value));
  maxBtn.addEventListener('click', () => updateFromAmount(BALANCE));

  // simple validation helper
  function validateWithdraw(){
    const amount = Number(amountInput.value) || 0;
    if(amount <= 0) { alert('Enter an amount greater than 0'); return false; }
    if(amount > BALANCE) { alert('Amount exceeds available balance'); return false; }
    // check destination depending on method
    const method = tabs.find(t => t.dataset.active === "true").dataset.method;
    if(method === 'momo'){
      const phone = document.getElementById('momoPhone').value.trim();
      if(!phone) { alert('Enter recipient phone for Momo'); return false; }
    } else if(method === 'fnb'){
      const acc = document.getElementById('fnbAcc').value.trim();
      if(!acc) { alert('Enter account/eWallet ID for FNB eWallet'); return false; }
    } else if(method === 'crypto'){
      const addr = document.getElementById('cryptoAddr').value.trim();
      if(!addr) { alert('Enter recipient wallet address'); return false; }
    }
    return true;
  }

  // simulate server call (replace with real fetch to /api/withdraw)
  function simulateWithdrawRequest(payload){
    return new Promise((resolve, reject) => {
      // simulate network + processing
      let progress = 0;
      const id = 'WD-' + Math.random().toString(36).slice(2,9).toUpperCase();
      const interval = setInterval(()=>{
        progress += 12 + Math.random()*18;
        if(progress >= 100){
          clearInterval(interval);
          // random success/fail
          const ok = true; // set false to simulate failure
          setTimeout(()=> ok ? resolve({ ok:true, txId: id }) : reject({ error:'network' }), 300);
        } else {
          // animate progress bar inside modal if needed
        }
      }, 220);
    });
  }

  // withdraw click
  withdrawBtn.addEventListener('click', async () => {
    if(!validateWithdraw()) return;
    const amount = Number(amountInput.value);
    const method = tabs.find(t => t.dataset.active === "true").dataset.method;

    // disable UI
    withdrawBtn.disabled = true;
    withdrawBtn.textContent = 'Processing...';
    withdrawBtn.style.opacity = 0.85;

    // small local progress animation (bar grows)
    progressBar.style.transition = 'width 400ms cubic-bezier(.2,.9,.2,1)';

    try {
      const payload = {
        amount, method,
        dest: method === 'momo' ? document.getElementById('momoPhone').value.trim() :
              method === 'fnb' ? document.getElementById('fnbAcc').value.trim() :
              document.getElementById('cryptoAddr').value.trim(),
        feePercent: FEE_PERCENT
      };

      // CALL to server: replace simulateWithdrawRequest with your real fetch
      const res = await simulateWithdrawRequest(payload);

      // success UI
      modalTitle.textContent = 'Withdrawal Sent';
      modalMessage.textContent = `Tx ID: ${res.txId}\nWe processed your request. It may take a few minutes.`;
      modalBackdrop.style.display = 'flex';
      setTimeout(()=> modal.classList.add('show'), 20);

      // pulse check + style (already handled via CSS keyframes)
      // update balance locally
      const fee = (FEE_PERCENT/100)*amount;
      const newBalance = BALANCE - amount;
      // NOTE: For demo we don't mutate BALANCE constant ‚Äî instead show visually:
      balanceEl.textContent = ( (Number(balanceEl.dataset || BALANCE) - amount) ).toLocaleString() + ' ZAC';
      // In real app: fetch fresh balance from server
    } catch(err){
      alert('Withdraw failed: ' + (err && err.error ? err.error : 'unknown'));
    } finally {
      withdrawBtn.disabled = false;
      withdrawBtn.textContent = 'Withdraw';
      withdrawBtn.style.opacity = 1;
      // reset progress bar
      setTimeout(()=> progressBar.style.width = ( (Number(amountInput.value) / BALANCE) * 100) + '%' , 500);
    }
  });

  // close modal
  closeModal.addEventListener('click', ()=> {
    modal.classList.remove('show');
    setTimeout(()=> modalBackdrop.style.display = 'none', 260);
  });

  // keyboard accessibility: Enter triggers withdraw when focused on amount
  amountInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter') withdrawBtn.click();
  });

  // small: update tooltip/data-balance dataset to reflect current displayed balance
  // (for demo, we keep static)
</script>
</body>
</html>