<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Zep Swipe — Send</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.0/dist/ethers.min.js"></script>

  <style>
    :root{
      --zep-blue:#00f0ff;
      --zep-violet:#9c4dff;
      --glass:rgba(255,255,255,0.06);
      --bg:radial-gradient(circle at 25% 10%, #020014 0%, #00000a 100%);
    }

    body{
      margin:0;background:var(--bg);color:#fff;
      font-family:'Poppins',sans-serif;
      display:flex;flex-direction:column;
      min-height:100vh;
    }

    .wrap{flex:1;padding:20px;max-width:900px;margin:0 auto;}

    /* HEADER */
    .header{
      padding:16px;border-radius:16px;
      background:var(--glass);
      border:1px solid rgba(255,255,255,0.1);
      backdrop-filter:blur(12px);
      display:flex;justify-content:space-between;align-items:center;
      box-shadow:0 0 30px rgba(0,240,255,0.10);
      margin-bottom:20px;
    }
    .brand{
      font-family:'Orbitron';
      font-size:1.5rem;
      background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }
    .addr{
      font-family:'Orbitron';
      font-size:0.9rem;color:#c6f9ff;text-align:right;
    }
    .logout{
      background:transparent;border:0;cursor:pointer;margin-top:6px;
      filter:drop-shadow(0 0 8px rgba(255,80,80,0.9));
    }

    /* CARD */
    .card{
      padding:20px;border-radius:16px;
      background:rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.1);
      backdrop-filter:blur(14px);
      box-shadow:0 0 25px rgba(0,240,255,0.08);
    }

    .title{
      font-family:'Orbitron';
      font-size:1.3rem;
      background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      margin-bottom:14px;
    }

    input{
      width:100%;padding:12px;border-radius:14px;margin-top:8px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.02);
      color:#fff;font-size:1rem;
    }

    label{font-weight:600;font-size:0.9rem;}

    .btn{
      margin-top:14px;width:100%;padding:14px;border-radius:14px;
      font-family:'Orbitron';font-weight:700;font-size:1rem;
      border:none;cursor:pointer;
      background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
      color:#050015;
      box-shadow:0 0 25px rgba(0,240,255,0.18);
    }

    .status{
      margin-top:12px;font-size:0.9rem;color:#cfeffd;min-height:20px;
    }

    /* FOOTER */
    .footer{
      position:fixed;left:0;right:0;bottom:0;
      padding:12px 22px;
      background:rgba(0,0,0,0.55);
      backdrop-filter:blur(10px);
      display:flex;justify-content:space-around;
      border-top:1px solid rgba(255,255,255,0.08);
    }
    .fbtn{
      width:60px;height:60px;border-radius:16px;cursor:pointer;
      background:rgba(255,255,255,0.05);
      display:flex;align-items:center;justify-content:center;
      border:1px solid rgba(255,255,255,0.1);
      transition:0.25s;
    }
    .fbtn:hover{
      transform:translateY(-6px);
      box-shadow:0 0 20px rgba(156,77,255,0.35);
    }
  </style>
</head>

<body>

<div class="wrap">

  <!-- HEADER -->
  <div class="header">
    <div class="brand">Zep Swipe</div>

    <div style="text-align:right">
      <div id="walletShort" class="addr">—</div>

      <button class="logout" id="logoutBtn">
        <svg width="20" height="20" fill="none" stroke="#ff6b6b" stroke-width="1.6">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- SEND CARD -->
  <div class="card">
    <div class="title">Send USDT</div>

    <label>Recipient Address</label>
    <input id="toAddr" placeholder="0x...">

    <label style="margin-top:12px">Amount (USDT)</label>
    <input id="amt" type="number" min="0" step="0.000001" placeholder="0.00">

    <button class="btn" id="sendNow">Send Now</button>

    <div class="status" id="statusBox"></div>
  </div>
</div>

<!-- FOOTER -->
<div class="footer">

  <!-- Home -->
  <a class="fbtn" href="student-dashboard.html">
    <svg width="28" height="28" viewBox="0 0 24 24" stroke="url(#h1)" fill="none" stroke-width="1.4">
      <rect x="3" y="7" width="18" height="13" rx="2"/>
      <path d="M3 11h18"/>
      <defs><linearGradient id="h1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
    </svg>
  </a>

  <!-- Send (active) -->
  <a class="fbtn" href="send.html">
    <svg width="28" height="28" viewBox="0 0 24 24" stroke="url(#s1)" fill="none" stroke-width="1.6">
      <path d="M22 2L11 13"/>
      <path d="M22 2l-7 20"/>
      <defs><linearGradient id="s1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
    </svg>
  </a>

  <!-- Profile -->
  <a class="fbtn" href="profile.html">
    <svg width="28" height="28" viewBox="0 0 24 24" stroke="url(#p1)" fill="none" stroke-width="1.4">
      <circle cx="12" cy="8" r="3"/>
      <path d="M4 20c1.5-4 7-6 8-6s6.5 2 8 6"/>
      <defs><linearGradient id="p1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
    </svg>
  </a>
</div>

<script>
const USDT = "0xdAC17F958D2ee523a2206206994597C13D831ec7";
const ABI = [
  "function transfer(address to, uint amount) returns (bool)",
  "function decimals() view returns (uint8)"
];

function shortAddr(a){ return a ? a.slice(0,6) + "..." + a.slice(-4) : "—"; }

window.onload = () => {
  const s = JSON.parse(localStorage.getItem("zepStudent"));
  if(!s){ location.href="student-login.html"; return;}
  document.getElementById("walletShort").textContent = shortAddr(s.wallet);
};

document.getElementById("logoutBtn").onclick = () => {
  localStorage.removeItem("zepStudent");
  location.href = "index.html";
};

document.getElementById("sendNow").onclick = async ()=>{
  const to = document.getElementById("toAddr").value.trim();
  const amt = Number(document.getElementById("amt").value);
  const stat = document.getElementById("statusBox");

  if(!ethers.isAddress(to)){ stat.textContent="Invalid address"; return; }
  if(!(amt>0)){ stat.textContent="Invalid amount"; return; }

  try{
    stat.textContent="Opening wallet…";
    const provider = new ethers.BrowserProvider(window.ethereum);
    const signer = await provider.getSigner();

    const token = new ethers.Contract(USDT, ABI, signer);
    const dec = await token.decimals();
    const units = ethers.parseUnits(String(amt), dec);

    stat.textContent="Sending…";
    const tx = await token.transfer(to, units);
    await tx.wait();
    stat.textContent="✅ Sent successfully!";
  }catch(e){
    stat.textContent="❌ Transaction failed.";
  }
};
</script>

</body>
</html>