<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Zep Swipe â€” Connect Wallet</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
<script src="https://cdn.tailwindcss.com"></script>

<style>
:root {
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
}
body {
  font-family:'Poppins',sans-serif;
  background:radial-gradient(circle at 25% 10%, #050018 0%, #000010 100%);
  color:#fff;
  height:100vh;
  margin:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}
h1 {
  font-family:'Orbitron';
  font-size:2rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:1rem;
}
button {
  width:260px;
  padding:14px 24px;
  border:none;
  border-radius:999px;
  font-family:'Orbitron';
  font-weight:700;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  color:#050018;
  cursor:pointer;
  box-shadow:0 0 25px rgba(0,240,255,0.5);
}
button:hover {
  transform:scale(1.05);
}
footer {
  position:fixed;
  bottom:15px;
  opacity:0.6;
  font-size:0.8rem;
}
</style>
</head>

<body>

<h1>Zep Swipe</h1>
<p style="opacity:0.7;max-width:260px;text-align:center;margin-bottom:1.5rem;">
  Connect your wallet to continue to your Merchant Dashboard.
</p>

<button onclick="connectWallet()">ðŸ”— Connect Wallet</button>

<footer>Â© 2025 Zep Swipe â€” Web3 Merchant MVP</footer>

<script>
async function connectWallet() {
  if (!window.ethereum) {
    alert("ðŸš¨ No wallet detected! Install MetaMask or open in Coinbase Wallet.");
    return;
  }

  try {
    console.log("â³ Requesting wallet...");
    const accounts = await window.ethereum.request({
      method: "eth_requestAccounts"
    });

    if (!accounts || accounts.length === 0) {
      alert("âš ï¸ No wallet connected.");
      return;
    }

    const wallet = accounts[0];
    console.log("Wallet connected:", wallet);

    // Save merchant session
    localStorage.setItem(
      "zepUser",
      JSON.stringify({ wallet, loggedIn: true })
    );

    // FIX FOR MOBILE METAMASK â€” Give the browser time to return focus
    setTimeout(() => {
      console.log("âž¡ï¸ Redirecting to merchants-dashboard.html");
      window.location.href = "merchants-dashboard.html";
    }, 300); // 300ms works best on MetaMask mobile

  } catch (err) {
    console.error("Login error:", err);
    alert("âš ï¸ Wallet connection failed.");
  }
}

// Auto-login if already saved
window.addEventListener("load", () => {
  const user = JSON.parse(localStorage.getItem("zepUser"));
  if (user && user.loggedIn) {
    setTimeout(() => {
      window.location.href = "merchants-dashboard.html";
    }, 300);
  }
});
</script>

</body>
</html>