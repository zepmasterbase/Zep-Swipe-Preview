<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zep Swipe ‚Äî Learn & Earn</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    :root{
      --zep-blue:#00f0ff;
      --zep-violet:#9c4dff;
      --glass: rgba(255,255,255,0.05);
      --bg: radial-gradient(circle at 20% 10%, #020014 0%, #000007 100%);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Poppins',sans-serif;
      background:var(--bg);
      color:#fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }

    .wrap{max-width:980px;margin:28px auto;padding:18px;width:100%;flex:1 0 auto;}

    .header{
      display:flex;justify-content:space-between;align-items:center;
      padding:14px;border-radius:12px;background:var(--glass);
      border:1px solid rgba(255,255,255,0.08);backdrop-filter:blur(10px);
      box-shadow:0 10px 30px rgba(0,240,255,0.04);margin-bottom:18px;
    }
    .brand{font-family:Orbitron;font-size:20px;background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .addr{font-family:Orbitron;color:#bffcff}
    .logout{
      background:transparent;border:0;padding:8px;border-radius:8px;cursor:pointer;filter:drop-shadow(0 0 8px rgba(255,80,80,0.8));
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;padding:18px;border:1px solid rgba(255,255,255,0.06);
      box-shadow:0 8px 36px rgba(0,240,255,0.03);backdrop-filter:blur(12px);
    }

    .title{
      font-family:Orbitron;font-size:1.4rem;
      background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      margin-bottom:10px;
      text-shadow:0 0 12px rgba(0,240,255,0.12);
    }

    .desc{color:#cfeffd;opacity:0.95;margin-bottom:18px}

    .quiz-area{display:flex;gap:18px;flex-direction:column}
    .progress{
      height:10px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden;margin-bottom:14px;
    }
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));width:0%;transition:width .4s ease;}

    .question-box{
      padding:16px;border-radius:12px;background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
    }
    .qtext{font-weight:700;margin-bottom:12px;font-family:Orbitron}
    .answers{display:flex;flex-direction:column;gap:10px}
    .ans-btn{
      text-align:left;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);
      background:transparent;cursor:pointer;color:#eafcff;font-weight:600;
      transition:transform .12s, box-shadow .12s, background .12s;
    }
    .ans-btn:hover{transform:translateY(-4px);box-shadow:0 10px 28px rgba(0,240,255,0.04)}
    .ans-btn.selected{background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));color:#050015}

    .meta-row{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .small-muted{color:#bfefff;font-size:13px}

    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:14px}
    .btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700;font-family:Orbitron}
    .btn.primary{background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));color:#050015}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#eaffff}

    .result{
      margin-top:18px;padding:14px;border-radius:12px;background:linear-gradient(90deg, rgba(0,240,255,0.03), rgba(156,77,255,0.02));
      text-align:center;
    }

    .badge{
      display:inline-block;padding:10px 14px;border-radius:999px;background:linear-gradient(90deg,var(--zep-violet),var(--zep-blue));color:#050015;font-weight:800;margin-top:8px;
    }

    .analytics{
      margin-top:14px;display:flex;gap:12px;flex-wrap:wrap;align-items:center;
    }
    .stat{
      padding:10px 12px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.04);
      font-family:Orbitron;
    }

    /* footer */
    .footer{
      position:fixed;left:0;right:0;bottom:0;background:rgba(0,0,0,0.55);
      backdrop-filter:blur(8px);display:flex;justify-content:space-around;padding:12px 18px;border-top:1px solid rgba(255,255,255,0.03);
    }
    .fbtn{width:68px;height:68px;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(255,255,255,0.03);filter:drop-shadow(0 8px 20px rgba(0,240,255,0.04));transition:transform .18s}
    .fbtn:hover{transform:translateY(-6px);filter:drop-shadow(0 14px 40px rgba(156,77,255,0.12));}

    /* small responsive */
    @media (max-width:720px){
      .wrap{padding:12px}
    }

    /* fade out for logout */
    body.fade-out{opacity:0; transition:opacity .55s ease;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header card">
      <div>
        <div class="brand">Zep Swipe</div>
        <div class="small-muted" style="font-size:13px;color:#cfeffd">Learn & Earn ‚Äî Level up & claim ZAC</div>
      </div>

      <div style="text-align:right">
        <div id="walletShort" class="addr">‚Äî</div>
        <div style="margin-top:8px">
          <button id="logoutBtn" class="logout" title="Logout" aria-label="Logout">
            <!-- logout icon -->
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="title">Zep Swipe ‚Äî Learn & Earn</div>
      <div class="desc">Answer the short quiz. Score <strong>3/10</strong> or higher to unlock <strong>Level 4</strong> and claim a simulated <strong>25 ZAC</strong> reward. Progress is saved to your browser.</div>

      <div class="quiz-area">
        <div class="progress"><i id="progBar"></i></div>

        <div class="question-box" id="questionBox">
          <!-- Question content injected here -->
        </div>

        <div class="meta-row">
          <div class="small-muted" id="qCounter">Question 1 / 10</div>
          <div class="small-muted" id="scoreDisplay">Score: 0</div>
        </div>

        <div class="controls">
          <button class="btn ghost" id="prevBtn" disabled>‚Üê Prev</button>
          <button class="btn primary" id="nextBtn">Next ‚Üí</button>
          <button class="btn ghost" id="submitBtn" style="display:none">Submit Quiz</button>
        </div>

        <div id="resultArea"></div>

        <div class="analytics" id="analyticsArea" style="display:none">
          <div class="stat" id="statScore">Score: ‚Äî</div>
          <div class="stat" id="statBadge">Badges: ‚Äî</div>
          <div class="stat" id="statClaim">Reward Claimed: ‚Äî</div>
        </div>
      </div>
    </div>
  </div>

  <!-- footer -->
  <div class="footer">
    <a class="fbtn" href="student-dashboard.html" title="Home" aria-label="Home">
      <svg width="30" height="30" viewBox="0 0 24 24" fill="none">
        <rect x="3" y="7" width="18" height="13" rx="2" stroke="url(#gH)" stroke-width="1.2"/>
        <path d="M3 11h18" stroke="url(#gH)" stroke-width="1.2"/>
        <defs><linearGradient id="gH" x1="0" x2="1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
      </svg>
    </a>

    <a class="fbtn" href="send.html" title="Send" aria-label="Send">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
        <path d="M22 2L11 13" stroke="url(#gS)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M22 2l-7 20" stroke="url(#gS)" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
        <defs><linearGradient id="gS" x1="0" x2="1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
      </svg>
    </a>

    <a class="fbtn" href="profile.html" title="Profile" aria-label="Profile">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="8" r="3" stroke="url(#gP)" stroke-width="1.4"/>
        <path d="M4 20c1.5-4 7-6 8-6s6.5 2 8 6" stroke="url(#gP)" stroke-width="1.4"/>
        <defs><linearGradient id="gP" x1="0" x2="1"><stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/></linearGradient></defs>
      </svg>
    </a>
  </div>

<script>
  // ====== Quiz data (same 10 Qs) ======
  const QUESTIONS = [
    { q: "What is the biggest advantage of selling BOTH on-chain and off-chain with Zep Swipe?", choices: ["You pay higher fees","You earn from two customer groups at the same time","You can only sell physical goods","ZAC becomes fiat"], answer: 1 },
    { q: "What makes $ZAC a suitable student currency for micro-payments?", choices: ["It fluctuates like Bitcoin","It is designed for African student spending + fast cross-border transfers","It can only be used by vendors","It requires mining"], answer: 1 },
    { q: "When a student completes a sale on ZepShop, where can their earnings go?", choices: ["Only to a bank account","Only to MoMo","Into their Zep Swipe wallet (ZAC + USDT)","Nowhere"], answer: 2 },
    { q: "Which of these is a MAJOR benefit of vendors accepting ZAC?", choices: ["They get free advertising from Zep Swipe","They avoid cross-border payment delays","It replaces their existing business completely","It makes customers anonymous"], answer: 1 },
    { q: "What is the purpose of the Zep Swipe ‚ÄúRequest Money‚Äù feature for students?", choices: ["To ask brands for sponsorship","To request funds instantly from family, friends, or clients","To generate random money","To receive loans"], answer: 1 },
    { q: "Which digital product is BEST suited for students who want fast income on ZepShop?", choices: ["Expensive hardware products","Handmade goods","E-books, fitness plans, music, digital guides","Cars"], answer: 2 },
    { q: "What happens when a student completes all Zep Swipe Learn & Earn levels?", choices: ["Nothing changes","They earn a blockchain certificate + ZAC rewards","They lose access","Their account resets"], answer: 1 },
    { q: "Why are on-chain badges important for African students?", choices: ["They work as NFTs that can be resold","They become proof-of-skill that employers can verify digitally","They allow students to skip school","They increase tuition fees"], answer: 1 },
    { q: "Which of the following shows a REAL use case of ZAC?", choices: ["Trading memes","Paying for campus food, notes, rides, or digital products","Buying stocks","Paying government taxes"], answer: 1 },
    { q: "Why is Zep Swipe considered a ‚ÄúStudent Super App‚Äù?", choices: ["It allows students to play games","It combines wallet + marketplace + rewards + vendor payments in one place","It is only used for sending crypto","It competes with universities"], answer: 1 }
  ];

  // ====== Settings: pass threshold 3 => unlock Level 4; reward 25 ZAC
  const PASS_THRESHOLD = 3;
  const REWARD_ZAC = 25;

  // ====== State ======
  let curIndex = 0;
  let selected = Array(QUESTIONS.length).fill(null);
  let score = 0;

  // UI refs
  const qBox = document.getElementById('questionBox');
  const progBar = document.getElementById('progBar');
  const qCounter = document.getElementById('qCounter');
  const scoreDisplay = document.getElementById('scoreDisplay');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const submitBtn = document.getElementById('submitBtn');
  const resultArea = document.getElementById('resultArea');
  const walletShort = document.getElementById('walletShort');
  const analyticsArea = document.getElementById('analyticsArea');
  const statScore = document.getElementById('statScore');
  const statBadge = document.getElementById('statBadge');
  const statClaim = document.getElementById('statClaim');

  // session helpers
  function getStudentSession(){ try{ return JSON.parse(localStorage.getItem('zepStudent')) || null;}catch(e){return null;} }
  function saveLearnProgress(){ localStorage.setItem('zepLearn', JSON.stringify({ selected, score, curIndex, timestamp:Date.now() })); }
  function loadLearnProgress(){ try{ const obj = JSON.parse(localStorage.getItem('zepLearn')); if(obj){ selected = obj.selected || selected; score = obj.score || 0; curIndex = obj.curIndex || 0; } }catch(e){} }
  function shortAddr(a){ return a ? `${a.slice(0,6)}...${a.slice(-4)}` : '‚Äî'; }

  // render
  function renderQuestion(){
    const q = QUESTIONS[curIndex];
    qBox.innerHTML = '';
    const qEl = document.createElement('div'); qEl.className='qtext'; qEl.textContent = q.q;
    qBox.appendChild(qEl);

    const answers = document.createElement('div'); answers.className='answers';
    q.choices.forEach((c,i)=>{
      const b = document.createElement('button');
      b.className='ans-btn';
      if(selected[curIndex] === i) b.classList.add('selected');
      b.innerHTML = `<span style="opacity:.9">${String.fromCharCode(65+i)}.</span> ${c}`;
      b.onclick = ()=>{
        selected[curIndex] = i;
        Array.from(answers.children).forEach(ch => ch.classList.remove('selected'));
        b.classList.add('selected');
        saveLearnProgress();
        updateControls();
      };
      answers.appendChild(b);
    });
    qBox.appendChild(answers);
    qCounter.textContent = `Question ${curIndex+1} / ${QUESTIONS.length}`;
    updateProgressBar();
    updateControls();
  }

  function updateProgressBar(){
    const filled = ((curIndex) / (QUESTIONS.length - 1)) * 100;
    progBar.style.width = `${filled}%`;
  }

  function updateControls(){
    prevBtn.disabled = curIndex === 0;
    nextBtn.style.display = (curIndex < QUESTIONS.length - 1) ? 'inline-block' : 'none';
    submitBtn.style.display = (curIndex === QUESTIONS.length - 1) ? 'inline-block' : 'none';
    let liveScore = 0;
    for(let i=0;i<QUESTIONS.length;i++){
      if(selected[i] !== null && selected[i] === QUESTIONS[i].answer) liveScore++;
    }
    scoreDisplay.textContent = `Score: ${liveScore}`;
  }

  function goNext(){ if(curIndex < QUESTIONS.length - 1){ curIndex++; renderQuestion(); } }
  function goPrev(){ if(curIndex > 0){ curIndex--; renderQuestion(); } }

  function calculateScore(){
    let s = 0;
    for(let i=0;i<QUESTIONS.length;i++){
      if(selected[i] === QUESTIONS[i].answer) s++;
    }
    score = s;
    saveLearnProgress();
    return s;
  }

  function showResult(){
    const s = calculateScore();
    resultArea.innerHTML = '';
    const r = document.createElement('div'); r.className = 'result';
    r.innerHTML = `<div style="font-weight:800;font-family:Orbitron;font-size:18px">${s} / ${QUESTIONS.length}</div>
                   <div style="margin-top:8px">${s >= PASS_THRESHOLD ? 'üéâ Level 4 UNLOCKED' : 'Keep Practising ‚Äî Reach 3/10 to unlock Level 4'}</div>`;
    resultArea.appendChild(r);

    if(s >= PASS_THRESHOLD){
      const claimBtn = document.createElement('button');
      claimBtn.className = 'btn primary';
      claimBtn.style.marginTop = '12px';
      claimBtn.textContent = `Claim ${REWARD_ZAC} ZAC Reward`;
      claimBtn.onclick = claimReward;
      resultArea.appendChild(claimBtn);

      const badge = document.createElement('div'); badge.className='badge'; badge.textContent='Level 4 Badge';
      resultArea.appendChild(badge);
    } else {
      const tip = document.createElement('div'); tip.style.marginTop='12px'; tip.className='small-muted';
      tip.textContent = 'Tip: Review the questions you missed and try again.';
      resultArea.appendChild(tip);
    }

    // feedback per question
    const details = document.createElement('div'); details.style.marginTop='14px';
    QUESTIONS.forEach((Q, idx)=>{
      const row = document.createElement('div'); row.style.marginTop='8px';
      const chosen = selected[idx]; const correct = Q.answer;
      const ok = (chosen !== null && chosen === correct);
      row.innerHTML = `<div style="font-weight:700">Q${idx+1} ‚Äî ${ok ? 'Correct' : 'Wrong'}</div>
                       <div style="opacity:0.9">${Q.q}</div>
                       <div style="font-size:13px;color:${ok? '#a6ffb6':'#ffd4d4'};margin-top:6px">
                         Your: ${chosen===null ? 'No answer' : String.fromCharCode(65+chosen)+'. '+Q.choices[chosen]}<br>
                         Correct: ${String.fromCharCode(65+correct)}. ${Q.choices[correct]}
                       </div>`;
      details.appendChild(row);
    });
    resultArea.appendChild(details);

    // analytics
    analyticsArea.style.display = 'flex';
    statScore.textContent = `Score: ${s}/${QUESTIONS.length}`;
    const learnData = JSON.parse(localStorage.getItem('zepLearn')) || {};
    statBadge.textContent = `Badges: ${learnData.level4 ? 'Level 4' : '‚Äî'}`;
    statClaim.textContent = `Reward Claimed: ${learnData.rewardClaimed ? learnData.rewardAmount + ' ZAC' : 'No'}`;
  }

  function claimReward(){
    const session = getStudentSession();
    if(!session || !session.wallet){ alert('No student session found. Please login first.'); return; }
    const existing = JSON.parse(localStorage.getItem('zepLearn')) || {};
    if(existing.rewardClaimed){ alert('Reward already claimed.'); return; }

    // update zepStudent (simulated)
    const cur = JSON.parse(localStorage.getItem('zepStudent')) || {};
    const prev = Number(cur.zacAmount ?? 0);
    cur.zacAmount = prev + REWARD_ZAC;
    cur.levels = cur.levels || {}; cur.levels.level4 = true;
    localStorage.setItem('zepStudent', JSON.stringify(cur));

    // store learn progress
    existing.rewardClaimed = true;
    existing.rewardAmount = REWARD_ZAC;
    existing.level4 = true;
    existing.passedAt = Date.now();
    localStorage.setItem('zepLearn', JSON.stringify(existing));

    // UI updates
    statBadge.textContent = `Badges: Level 4`;
    statClaim.textContent = `Reward Claimed: ${REWARD_ZAC} ZAC`;
    const success = document.createElement('div'); success.className='badge'; success.style.marginTop='12px';
    success.textContent = `+${REWARD_ZAC} ZAC added (simulated) ‚Äî Level 4 unlocked`;
    resultArea.appendChild(success);
  }

  // init
  function init(){
    const s = getStudentSession();
    if(!s || !s.loggedIn || !s.wallet){
      location.href = 'student-login.html';
      return;
    }
    walletShort.textContent = shortAddr(s.wallet);
    loadLearnProgress();
    renderQuestion();
  }

  // controls
  prevBtn.addEventListener('click', ()=>goPrev());
  nextBtn.addEventListener('click', ()=>goNext());
  submitBtn.addEventListener('click', ()=>{
    const unanswered = selected.filter(x=>x===null).length;
    if(unanswered>0){
      if(!confirm(`You have ${unanswered} unanswered question(s). Submit anyway?`)) return;
    }
    showResult();
  });

  // logout fade + redirect to index
  document.getElementById('logoutBtn').addEventListener('click', ()=>{
    document.body.classList.add('fade-out');
    setTimeout(()=>{
      localStorage.removeItem('zepStudent');
      location.href = 'index.html';
    }, 550);
  });

  window.addEventListener('load', init);
</script>
</body>
</html>