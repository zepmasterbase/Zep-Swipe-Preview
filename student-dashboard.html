<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zep Swipe â€” Student Dashboard (MVP)</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/ethers@6.6.0/dist/ethers.min.js"></script>

<style>
  :root{
    --zep-blue:#00f0ff;
    --zep-violet:#9c4dff;
    --glass:rgba(255,255,255,0.06);
    --bg:radial-gradient(circle at 20% 10%, #030015 0%, #000007 100%);
  }
  body{margin:0;background:var(--bg);color:#fff;font-family:Poppins;height:100%;}
  .container{max-width:900px;margin:20px auto;padding:16px;}

  /* HEADER */
  .header{
    display:flex;justify-content:space-between;align-items:center;
    background:var(--glass);border:1px solid rgba(255,255,255,0.10);
    padding:14px;border-radius:14px;backdrop-filter:blur(14px);
    box-shadow:0 8px 30px rgba(0,240,255,0.06);
  }
  .brand{
    font-family:Orbitron;font-size:20px;font-weight:700;
    background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  }
  .sub{font-size:13px;color:#cfeffd;}
  .addr{font-family:Orbitron;font-size:14px;color:#aef8ff;}

  /* Logout */
  .logout{
    border:0;background:transparent;cursor:pointer;
    filter:drop-shadow(0 0 8px rgba(255,130,130,0.9));
  }

  /* CARDS */
  .card{
    background:rgba(255,255,255,0.03);
    border-radius:14px;border:1px solid rgba(255,255,255,0.06);
    padding:16px;margin-top:16px;
    backdrop-filter:blur(10px);
  }

  .kpi{display:flex;justify-content:space-between;align-items:center;}
  .kpi h3{
    margin:0;font-family:Orbitron;
    background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    font-size:20px;
  }
  .val{font-family:Orbitron;font-size:22px;color:#dcfff6;}

  .coin{
    width:70px;height:70px;border-radius:18px;
    background:linear-gradient(145deg,var(--zep-blue),var(--zep-violet));
    display:flex;align-items:center;justify-content:center;
    color:#050018;font-family:Orbitron;
  }

  .features{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px;}

  /* Active feature */
  .feature-active{
    padding:14px;border-radius:14px;text-align:center;cursor:pointer;
    background:linear-gradient(90deg,rgba(0,240,255,0.05),rgba(156,77,255,0.05));
    border:1px solid rgba(255,255,255,0.08);
    backdrop-filter:blur(8px);
  }

  /* Disabled (shown, dimmed, not clickable) */
  .feature-disabled{
    padding:14px;border-radius:14px;text-align:center;
    opacity:0.35;cursor:not-allowed;
    background:rgba(255,255,255,0.03);
    border:1px dashed rgba(255,255,255,0.05);
  }

  .feature-active h4,
  .feature-disabled h4 {
    margin:0;
    font-family:Orbitron;
    background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    font-size:14px;
  }

  .feature-active p, .feature-disabled p{
    font-size:12px;margin-top:6px;color:#ccecff;
  }

  /* ZEP AI FLOATING BUTTON */
  .ai-btn{
    position:fixed;right:18px;bottom:110px;
    background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
    color:#050018;font-family:Orbitron;font-weight:700;
    padding:12px 16px;border-radius:999px;
    box-shadow:0 0 25px rgba(156,77,255,0.4);
    cursor:pointer;
  }

  /* FOOTER */
  .footer{
    position:fixed;left:0;right:0;bottom:0;
    background:rgba(0,0,0,0.6);backdrop-filter:blur(8px);
    display:flex;justify-content:space-around;
    padding:14px;border-top:1px solid rgba(255,255,255,0.05);
  }

  .fbtn{
    width:58px;height:58px;border-radius:16px;
    display:flex;justify-content:center;align-items:center;
    filter:drop-shadow(0 8px 22px rgba(0,240,255,0.08));
  }
</style>
</head>

<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div>
      <div class="brand">Zep Swipe</div>
      <div class="sub">Student Dashboard â€” MVP Limited Access</div>
    </div>

    <div style="text-align:right">
      <div id="walletShort" class="addr">â€”</div>
      <button class="logout" id="logoutBtn" title="Logout">
        <svg width="22" height="22" viewBox="0 0 24 24" stroke="#ff6262" stroke-width="1.6" fill="none">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- WALLET CARD -->
  <div class="card">
    <div class="kpi">
      <h3>Wallet</h3>
      <div id="totalUSD" class="val">â‰ˆ $0.00</div>
    </div>

    <div style="display:flex;gap:12px;margin-top:12px;">
      <div class="coin">ZAC</div>
      <div>
        <p class="sub">Zep Cash (ZAC)</p>
        <p style="font-family:Orbitron;font-size:22px;margin:0" id="zacAmount">â€” ZAC</p>
        <p class="sub" id="zacUSD">â‰ˆ $0.00</p>
      </div>
    </div>

    <div class="features">
      <!-- ACTIVE -->
      <a href="wallet.html" class="feature-active">
        <h4>Wallet</h4><p>Send / Receive</p>
      </a>

      <a href="learn-earn.html" class="feature-active">
        <h4>Earn</h4><p>Complete tasks</p>
      </a>
    </div>
  </div>

  <!-- QUICK ACTIONS -->
  <div class="card">
    <h3 style="margin:0 0 10px 0;font-family:Orbitron;
      background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;">
      Student Tools
    </h3>
    <p class="sub">Some features locked for MVP</p>

    <div class="features">

      <div class="feature-disabled">
        <h4>Store</h4><p>Soon</p>
      </div>

      <div class="feature-disabled">
        <h4>Parcel On</h4><p>Soon</p>
      </div>

      <div class="feature-disabled">
        <h4>Swipe Rides</h4><p>Soon</p>
      </div>

      <div class="feature-disabled">
        <h4>Zep Study</h4><p>Soon</p>
      </div>
    </div>
  </div>

</div>

<!-- ZEP AI -->
<button class="ai-btn" onclick="openZepAI()">ðŸ’¬ Zep AI</button>

<!-- FOOTER (Only Profile Active) -->
<div class="footer">

  <div class="fbtn" style="opacity:0.35;cursor:not-allowed;">
    <!-- disabled -->
    <svg width="26" height="26" stroke="#666"><circle cx="12" cy="12" r="10"/></svg>
  </div>

  <div class="fbtn" style="opacity:0.35;cursor:not-allowed;">
    <svg width="26" height="26" stroke="#666"><rect x="4" y="4" width="16" height="16"/></svg>
  </div>

  <a class="fbtn" href="profile.html">
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
      <circle cx="12" cy="8" r="3" stroke="url(#gradP)" stroke-width="1.6"/>
      <path d="M4 20c1.7-4 7-6 8-6s6.3 2 8 6" stroke="url(#gradP)" stroke-width="1.6"/>
      <defs>
        <linearGradient id="gradP" x1="0" x2="1">
          <stop stop-color="#00f0ff"/><stop offset="1" stop-color="#9c4dff"/>
        </linearGradient>
      </defs>
    </svg>
  </a>

</div>

<script>
const ZAC = "0xfe4119a9cac1425d808526905e92386b4234bf2a";
const ABI = [
  "function balanceOf(address owner)view returns(uint256)",
  "function decimals() view returns(uint8)"
];
const RPC = "https://mainnet.base.org";

function short(a){return `${a.slice(0,6)}...${a.slice(-4)}`;}

document.getElementById("logoutBtn").onclick = ()=>{
  localStorage.removeItem("zepStudent");
  location.href="student-login.html";
};

window.onload = async ()=>{
  let user = JSON.parse(localStorage.getItem("zepStudent"));
  if(!user){ location.href="student-login.html"; return; }

  document.getElementById("walletShort").textContent = short(user.wallet);

  const provider = new ethers.JsonRpcProvider(RPC);
  const c = new ethers.Contract(ZAC,ABI,provider);

  try{
    let dec = await c.decimals();
    let bal = await c.balanceOf(user.wallet);
    let f = Number(ethers.formatUnits(bal,dec));
    document.getElementById("zacAmount").textContent = f+" ZAC";

    let usd = f * 0.15;
    document.getElementById("zacUSD").textContent = "â‰ˆ $"+usd.toFixed(2);
    document.getElementById("totalUSD").textContent = "â‰ˆ $"+usd.toFixed(2);

  }catch(e){
    console.log(e);
  }
};

function openZepAI(){
  window.location.href="zep-ai.html";
}
</script>

</body>
</html>